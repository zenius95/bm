<%# views/partials/_pagination.ejs %>
<% if (pagination && pagination.totalPages > 1) { %>
    <nav aria-label="Page navigation">
        <ul class="flex justify-center items-center gap-2 text-sm">
            <%
                const currentPage = pagination.currentPage;
                const totalPages = pagination.totalPages;
                const query = new URLSearchParams(currentQuery);

                function pageLink(page) {
                    query.set('page', page);
                    return `?${query.toString()}`;
                }

                // Nút "Trang Trước"
                const prevDisabled = currentPage === 1;
            %>
            <li>
                <a href="<%= prevDisabled ? '#' : pageLink(currentPage - 1) %>"
                   class="inline-flex items-center justify-center w-10 h-10 rounded-lg border transition-colors duration-200
                          <%= prevDisabled ? 'text-gray-600 bg-gray-800/50 border-gray-700 cursor-not-allowed' : 'text-gray-400 bg-white/5 border-white/10 hover:bg-white/10 hover:text-white' %>">
                    <span class="sr-only">Previous</span>
                    <i class="ri-arrow-left-s-line text-xl"></i>
                </a>
            </li>

            <%
                const pagesToShow = new Set();
                pagesToShow.add(1); // Luôn hiển thị trang đầu
                pagesToShow.add(totalPages); // Luôn hiển thị trang cuối
                pagesToShow.add(currentPage);
                
                // Thêm các trang liền kề
                if (currentPage > 1) pagesToShow.add(currentPage - 1);
                if (currentPage < totalPages) pagesToShow.add(currentPage + 1);

                const sortedPages = Array.from(pagesToShow).sort((a, b) => a - b);
                let lastPage = 0;

                sortedPages.forEach(page => {
                    // Thêm dấu "..." nếu có khoảng cách
                    if (page - lastPage > 1) { %>
                        <li>
                            <span class="inline-flex items-center justify-center w-10 h-10 text-gray-500">...</span>
                        </li>
                    <% } %>
                    <li>
                        <a href="<%= pageLink(page) %>"
                           aria-current="<%= page === currentPage ? 'page' : 'false' %>"
                           class="inline-flex items-center justify-center w-10 h-10 rounded-lg border font-semibold transition-colors duration-200
                                  <%= page === currentPage ? 'text-white bg-blue-600 border-blue-500 shadow-md shadow-blue-500/20 z-10' : 'text-gray-300 bg-white/5 border-white/10 hover:bg-white/10 hover:border-blue-500/50' %>">
                            <%= page %>
                        </a>
                    </li>
                <%
                    lastPage = page;
                });
            %>

            <%
                // Nút "Trang Kế"
                const nextDisabled = currentPage === totalPages;
            %>
            <li>
                <a href="<%= nextDisabled ? '#' : pageLink(currentPage + 1) %>"
                   class="inline-flex items-center justify-center w-10 h-10 rounded-lg border transition-colors duration-200
                          <%= nextDisabled ? 'text-gray-600 bg-gray-800/50 border-gray-700 cursor-not-allowed' : 'text-gray-400 bg-white/5 border-white/10 hover:bg-white/10 hover:text-white' %>">
                    <span class="sr-only">Next</span>
                    <i class="ri-arrow-right-s-line text-xl"></i>
                </a>
            </li>
        </ul>
    </nav>
<% } %>